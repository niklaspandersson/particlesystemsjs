!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.particleSystems=e():t.particleSystems=e()}(window,(function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(r(4));class a extends n.default{constructor(t,e,r){super(t,e),this.lifetime=r,this.age=this.normalizedAge=0}updateAge(t){return this.age+=t,this.normalizedAge=Math.min(1,this.age/this.lifetime),this.age<this.lifetime}}e.Particle=a,e.default=a},function(t,e,r){"use strict";function i(t){return Math.sqrt(t.x*t.x+t.y*t.y)}Object.defineProperty(e,"__esModule",{value:!0}),e.magnitude=i,e.normalize=function(t){const e=i(t);return{x:t.x/e,y:t.y/e}};e.Vec2=class{constructor({x:t=0,y:e=0}={}){this.data=[0,0],this.data[0]=t,this.data[1]=e}get x(){return this.data[0]}get y(){return this.data[1]}add(t){return this.data[0]+=t.x,this.data[1]+=t.y,this}addScaled(t,e){return this.data[0]+=t.x*e,this.data[1]+=t.y*e,this}scale(t){this.data[0]*=t,this.data[1]*=t}};var n=r(2);e.gaussian=n.gaussian},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.random=function({min:t,max:e}){return t+Math.random()*(e-t)},e.randomize=function(t){return t[Math.floor(Math.random()*t.length)]};var i=r(6);e.gaussian=i.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(0);e.Particle=i.Particle;var n=r(5);e.ParticleSystem=n.ParticleSystem},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e){this.position=t,this.velocity=e}}e.Entity=i,e.default=i},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),a=r(7),o=i(r(8)),s={initialCount:0,position:{x:0,y:0},emitter:{particlesPerSecond:40,strategy:"random",particles:{initialPos:{x:{min:-10,max:10},y:0},initialVelocity:{x:0,y:{max:-10,min:-100}},lifetime:3}}};function c(t){return t.position.addScaled(t.velocity,this.deltaTime),t.updateAge(this.deltaTime)}function u(t){return t.velocity.addScaled(this.forces,this.deltaTime),t.velocity.scale(this.dampening),t.position.addScaled(t.velocity,this.deltaTime),t.updateAge(this.deltaTime)}e.ParticleSystem=class{constructor(t,e){this.lastTime=0,this.animationFrameId=null;const r=o.default(s,t);this._forces=r.forces,this.update=this._forces?this.updatePhysics.bind(this):this.updateStatic.bind(this),this._pos=r.position,this._dampening=1,this.draw=e,this._emitter=new a.ParticleEmitter(r.emitter),this._particles=this._emitter.init(r.initialCount),this.onAnimationFrame=this.onAnimationFrame.bind(this)}get particles(){return this._particles}get position(){return this._pos}start(){this.animationFrameId||(this.animationFrameId=window.requestAnimationFrame(t=>{this.lastTime=t,this.animationFrameId=window.requestAnimationFrame(this.onAnimationFrame)}))}stop(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null}onAnimationFrame(t){const e=(t-this.lastTime)/1e3;this.lastTime=t;const r=this._emitter.isAlive&&this._emitter.onUpdate(e);r&&this.particles.push(...r),this.update(e),this.draw(this,e),this.animationFrameId=window.requestAnimationFrame(this.onAnimationFrame),this._emitter.isAlive||this.particles.length||this.stop()}updatePhysics(t){let e=new n.Vec2;for(const t in this._forces)e.add(this._forces[t]);const r={forces:e,dampening:this._dampening,deltaTime:t};this._particles=this._particles.filter(u,r)}updateStatic(t){const e={deltaTime:t};this._particles=this._particles.filter(c,e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=function(){var t=123456789,e=Array(128),r=Array(128),i=Array(128);function n(){const t=a(),n=127&t;return Math.abs(t)<i[n]?t*e[n]:function(t,n){const s=3.442619855899,c=1/s;let u,l;for(;;){if(u=t*e[n],0==n){for(u=-Math.log(o())*c,l=-Math.log(o());l+l<u*u;)u=-Math.log(o())*c,l=-Math.log(o());return t>0?s+u:-s-u}if(r[n]+o()*(r[n-1]-r[n])<Math.exp(-.5*u*u))return u;if(t=a(),n=127&t,Math.abs(t)<i[n])return t*e[n]}}(t,n)}function a(){var e=t,r=t;return r^=r<<13,r^=r>>>17,t=r^=r<<5,e+r|0}function o(){return.5*(1+a()/-Math.pow(2,31))}return function(){t^=(new Date).getTime();var n=2147483648,a=3.442619855899,o=a,s=.00991256303526217,c=s/Math.exp(-.5*a*a);i[0]=Math.floor(a/c*n),i[1]=0,e[0]=c/n,e[127]=a/n,r[0]=1,r[127]=Math.exp(-.5*a*a);for(var u=126;u>=1;u--)a=Math.sqrt(-2*Math.log(s/a+Math.exp(-.5*a*a))),i[u+1]=Math.floor(a/o*n),o=a,r[u]=Math.exp(-.5*a*a),e[u]=a/n}(),function(t=0,e=1){return n()*e+t}}();e.default=i},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(r(0)),a=r(1),o=r(2);function s(t){if("function"==typeof t)return t;const e=c(t.x),r=c(t.y);return()=>({x:e(),y:r()})}function c(t){const e=t;if("function"==typeof e)return e;if("number"==typeof e)return function(){return e};if(e.hasOwnProperty("min")&&e.hasOwnProperty("max"))return function(){return o.random(t)};throw new Error("Invalid parameter")}e.ParticleEmitter=class{constructor(t){this._age=0,this._lifetime=t.lifetime||1/0,this._initialPositionFactory=s(t.particles.initialPos),this._initlalVelocityFactory=s(t.particles.initialVelocity),this._particleLifetimeFactory=c(t.particles.lifetime),this._customDataFactory=t.particles.customDataFactory,this.counter=function(t,e){switch(t.toLowerCase()){case"random":return function(t){let e=0;return function(r){const i=t*r;let n=0;do{n=a.gaussian(i,.8)}while(Math.abs(i-n)>i);const o=n+e,s=Math.floor(o);return e=o-s,s}}(e.particlesPerSecond);case"sequence":return function(t){var e;if(!(null===(e=t)||void 0===e?void 0:e.length))throw new Error("No sequence provided to emitter with sequence strategy");let r=0,i=0;return function(e){let n=0;for(r+=e;r>t[i];)++i>=t.length?(i=0,r-=t[t.length-1]):++n;return n}}(e.sequence);case"periodic":return function(t){let e=0;return function(r){const i=t*r+e,n=Math.floor(i);return e=i-n,n}}(e.particlesPerSecond);default:throw new Error(`unsupported emitter strategy: '${t}'`)}}(t.strategy,t)}get isAlive(){return this._age<this._lifetime}init(t){return Array(t).fill(null).map(t=>this.createParticle())}onUpdate(t){this._age+=t;const e=this.counter(t);return e?Array(e).fill(null).map(t=>this.createParticle()):null}createParticle(){const t=new n.default(new a.Vec2(this._initialPositionFactory()),new a.Vec2(this._initlalVelocityFactory()),this._particleLifetimeFactory());return this._customDataFactory&&(t.data=this._customDataFactory(t)),t}}},function(t,e,r){"use strict";var i=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===n}(t)}(t)};var n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((r=t,Array.isArray(r)?[]:{}),t,e):t;var r}function o(t,e,r){return t.concat(e).map((function(t){return a(t,r)}))}function s(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function c(t,e){try{return e in t}catch(t){return!1}}function u(t,e,r){var i={};return r.isMergeableObject(t)&&s(t).forEach((function(e){i[e]=a(t[e],r)})),s(e).forEach((function(n){(function(t,e){return c(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,n)||(c(t,n)&&r.isMergeableObject(e[n])?i[n]=function(t,e){if(!e.customMerge)return l;var r=e.customMerge(t);return"function"==typeof r?r:l}(n,r)(t[n],e[n],r):i[n]=a(e[n],r))})),i}function l(t,e,r){(r=r||{}).arrayMerge=r.arrayMerge||o,r.isMergeableObject=r.isMergeableObject||i,r.cloneUnlessOtherwiseSpecified=a;var n=Array.isArray(e);return n===Array.isArray(t)?n?r.arrayMerge(t,e,r):u(t,e,r):a(e,r)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,r){return l(t,r,e)}),{})};var f=l;t.exports=f}])}));