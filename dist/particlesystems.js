!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.particleSystems=e():t.particleSystems=e()}(window,(function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(i(4));class a extends n.default{constructor(t,e,i){super(t,e),this.lifetime=i,this.age=this.normalizedAge=0}updateAge(t){return this.age+=t,this.normalizedAge=Math.min(1,this.age/this.lifetime),this.age<this.lifetime}}e.Particle=a,e.default=a},function(t,e,i){"use strict";function r(t){return Math.sqrt(t.x*t.x+t.y*t.y)}Object.defineProperty(e,"__esModule",{value:!0}),e.magnitude=r,e.normalize=function(t){const e=r(t);return{x:t.x/e,y:t.y/e}};e.Vec2=class{constructor({x:t=0,y:e=0}={}){this.data=[0,0],this.data[0]=t,this.data[1]=e}get x(){return this.data[0]}get y(){return this.data[1]}add(t){return this.data[0]+=t.x,this.data[1]+=t.y,this}addScaled(t,e){return this.data[0]+=t.x*e,this.data[1]+=t.y*e,this}scale(t){this.data[0]*=t,this.data[1]*=t}};var n=i(2);e.gaussian=n.gaussian},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.random=function({min:t,max:e}){return t+Math.random()*(e-t)},e.randomize=function(t){return t[Math.floor(Math.random()*t.length)]};var r=i(6);e.gaussian=r.default},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(0);e.Particle=r.Particle;var n=i(5);e.ParticleSystem=n.ParticleSystem},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(t,e){this.position=t,this.velocity=e}}e.Entity=r,e.default=r},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(1),a=i(7),o=r(i(8)),s={initialCount:0,position:{x:0,y:0},emitter:{particlesPerSecond:40,strategy:"random",particles:{initialPos:{x:{min:-10,max:10},y:0},initialVelocity:{x:0,y:{max:-10,min:-100}},lifetime:3}}};function c(t){return t.position.addScaled(t.velocity,this.deltaTime),t.updateAge(this.deltaTime)}function u(t){return t.velocity.addScaled(this.forces,this.deltaTime),t.velocity.scale(this.dampening),t.position.addScaled(t.velocity,this.deltaTime),t.updateAge(this.deltaTime)}e.ParticleSystem=class{constructor(t,e){this.lastTime=0,this.animationFrameId=null;const i=o.default(s,t);this._forces=i.forces,this.update=this._forces?this.updatePhysics.bind(this):this.updateStatic.bind(this),this._pos=i.position,this._dampening=1,this.draw=e,this._emitter=new a.ParticleEmitter(i.emitter),this._particles=this._emitter.init(i.initialCount),this.onAnimationFrame=this.onAnimationFrame.bind(this)}get particles(){return this._particles}get position(){return this._pos}start(){this.animationFrameId||(this.animationFrameId=window.requestAnimationFrame(t=>{this.lastTime=t,this.animationFrameId=window.requestAnimationFrame(this.onAnimationFrame)}))}stop(){this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null}onAnimationFrame(t){const e=(t-this.lastTime)/1e3;this.lastTime=t;const i=this._emitter.onUpdate(e);i&&this.particles.push(...i),this.update(e),this.draw(this,e),this.animationFrameId=window.requestAnimationFrame(this.onAnimationFrame)}updatePhysics(t){let e=new n.Vec2;for(const t in this._forces)e.add(this._forces[t]);const i={forces:e,dampening:this._dampening,deltaTime:t};this._particles=this._particles.filter(u,i)}updateStatic(t){const e={deltaTime:t};this._particles=this._particles.filter(c,e)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=function(){var t=123456789,e=Array(128),i=Array(128),r=Array(128);function n(){const t=a(),n=127&t;return Math.abs(t)<r[n]?t*e[n]:function(t,n){const s=3.442619855899,c=1/s;let u,l;for(;;){if(u=t*e[n],0==n){for(u=-Math.log(o())*c,l=-Math.log(o());l+l<u*u;)u=-Math.log(o())*c,l=-Math.log(o());return t>0?s+u:-s-u}if(i[n]+o()*(i[n-1]-i[n])<Math.exp(-.5*u*u))return u;if(t=a(),n=127&t,Math.abs(t)<r[n])return t*e[n]}}(t,n)}function a(){var e=t,i=t;return i^=i<<13,i^=i>>>17,t=i^=i<<5,e+i|0}function o(){return.5*(1+a()/-Math.pow(2,31))}return function(){t^=(new Date).getTime();var n=2147483648,a=3.442619855899,o=a,s=.00991256303526217,c=s/Math.exp(-.5*a*a);r[0]=Math.floor(a/c*n),r[1]=0,e[0]=c/n,e[127]=a/n,i[0]=1,i[127]=Math.exp(-.5*a*a);for(var u=126;u>=1;u--)a=Math.sqrt(-2*Math.log(s/a+Math.exp(-.5*a*a))),r[u+1]=Math.floor(a/o*n),o=a,i[u]=Math.exp(-.5*a*a),e[u]=a/n}(),function(t=0,e=1){return n()*e+t}}();e.default=r},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(i(0)),a=i(1),o=i(2);function s(t){if("function"==typeof t)return t;const e=c(t.x),i=c(t.y);return()=>({x:e(),y:i()})}function c(t){const e=t;if("function"==typeof e)return e;if("number"==typeof e)return function(){return e};if(e.hasOwnProperty("min")&&e.hasOwnProperty("max"))return function(){return o.random(t)};throw new Error("Invalid parameter")}e.ParticleEmitter=class{constructor(t){this._opts=t,this._initialPositionFactory=s(t.particles.initialPos),this._initlalVelocityFactory=s(t.particles.initialVelocity),this._particleLifetimeFactory=c(t.particles.lifetime),this._customDataFactory=t.particles.customDataFactory}init(t){return Array(t).fill(null).map(t=>this.createParticle())}onUpdate(t){const e=this.randomParticleCount(t);return e?Array(e).fill(null).map(t=>this.createParticle()):null}createParticle(){const t=new n.default(new a.Vec2(this._initialPositionFactory()),new a.Vec2(this._initlalVelocityFactory()),this._particleLifetimeFactory());return this._customDataFactory&&(t.data=this._customDataFactory(t)),t}randomParticleCount(t){const e=this._opts.particlesPerSecond*t;let i=0;do{i=a.gaussian(e,.8)}while(Math.abs(e-i)>e);return Math.round(i)}}},function(t,e,i){"use strict";var r=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===n}(t)}(t)};var n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((i=t,Array.isArray(i)?[]:{}),t,e):t;var i}function o(t,e,i){return t.concat(e).map((function(t){return a(t,i)}))}function s(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function c(t,e){try{return e in t}catch(t){return!1}}function u(t,e,i){var r={};return i.isMergeableObject(t)&&s(t).forEach((function(e){r[e]=a(t[e],i)})),s(e).forEach((function(n){(function(t,e){return c(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,n)||(c(t,n)&&i.isMergeableObject(e[n])?r[n]=function(t,e){if(!e.customMerge)return l;var i=e.customMerge(t);return"function"==typeof i?i:l}(n,i)(t[n],e[n],i):r[n]=a(e[n],i))})),r}function l(t,e,i){(i=i||{}).arrayMerge=i.arrayMerge||o,i.isMergeableObject=i.isMergeableObject||r,i.cloneUnlessOtherwiseSpecified=a;var n=Array.isArray(e);return n===Array.isArray(t)?n?i.arrayMerge(t,e,i):u(t,e,i):a(e,i)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,i){return l(t,i,e)}),{})};var f=l;t.exports=f}])}));