!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.particleSystems=e():t.particleSystems=e()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t){return Math.sqrt(t.x**2+t.y**2)}Object.defineProperty(e,"__esModule",{value:!0});class r{constructor({x:t=0,y:e=0}={}){this.data=[0,0],this.data[0]=t,this.data[1]=e}get x(){return this.data[0]}get y(){return this.data[1]}add(t){return this.data[0]+=t.x,this.data[1]+=t.y,this}addScaled(t,e){return this.data[0]+=t.x*e,this.data[1]+=t.y*e,this}scale(t){this.data[0]*=t,this.data[1]*=t}}class o extends class{constructor(t,e){this.pos=t,this.velocity=e}}{constructor(t){super(new r(t.createPosition()),new r(t.createVelocity())),this.lifetime=t.createLifetime(),this.age=this.normalizedAge=0}update(t,e,i){return this.velocity.addScaled(t,i),this.velocity.scale(e),this.pos.addScaled(this.velocity,i),this.age+=i,this.normalizedAge=this.age/this.lifetime,this.age<this.lifetime}}const a={count:20,position:{x:0,y:0},forces:{},dampening:1,particle:{initialPos:{x:{min:-10,max:10},y:0},initialVelocity:{x:0,y:{max:-10,min:-100}}}};function s({min:t,max:e}){return t+Math.random()*(e-t)}function c(t){return"number"==typeof t?function(){return t}:function(){return s(t)}}function l(t,e){return c(e[t])}function u(t){const e=l("x",t),i=l("y",t);return function(){return{x:e(),y:i()}}}e.random=s,e.randomize=function(t){return t[Math.floor(Math.random()*t.length)]},e.createFactoryFromVector=function(t,e,i){const r=n(t),o=function(t){const e=n(t);return{x:t.x/e,y:t.y/e}}(t);let a=0!==o.x?Math.atan(o.y/o.x):90;o.y<0&&(a+=Math.PI);const c=a-e/2,l=a+e/2,u=r*i;return function(){const t=s({min:u,max:r}),e=s({min:c,max:l});return{x:Math.cos(e)*t,y:Math.sin(e)*t}}};e.ParticleSystem=class{constructor(t){this.lastTime=0,this.onStart=t=>{this.lastTime=t,this.onInit(this),this._particles=this.particles.sort((t,e)=>t.userData.color.localeCompare(e.userData.color)),window.requestAnimationFrame(this.doUpdate)};const e={...a,...t};this.forces=e.forces,this._pos=e.position,this.dampening=e.dampening||1,this.onUpdate=e.onUpdate||(()=>{}),this.onInit=e.onInit||(()=>{});const i={createPosition:"function"==typeof e.particle.initialPos?e.particle.initialPos:u(e.particle.initialPos),createVelocity:"function"==typeof e.particle.initialVelocity?e.particle.initialVelocity:u(e.particle.initialVelocity),createLifetime:"function"==typeof e.particle.lifetime?e.particle.lifetime:c(e.particle.lifetime||3)},n={...e.particle,...i};this._particles=Array(e.count).fill(null).map(t=>new o(n)),this.doUpdate=this.doUpdate.bind(this)}get particles(){return this._particles}get pos(){return this._pos}start(){window.requestAnimationFrame(this.onStart)}doUpdate(t){const e=(t-this.lastTime)/1e3;this.lastTime=t,this.update(e),this.onUpdate(this,e),window.requestAnimationFrame(this.doUpdate)}update(t){const e=this.dampening;let i=new r;for(const t in this.forces)i.add(this.forces[t]);this._particles=this._particles.filter((function(n){return n.update(i,e,t)}))}}}])}));